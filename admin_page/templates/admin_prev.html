{% extends "base.html" %}

{% set page_title = "Admin page" %}

{% block links %}
    <link rel = "stylesheet" href = "{{ url_for('admin.static', filename = '/css/style.css' ) }}">
    <script defer src = "{{ url_for('admin.static', filename = '/js/script.js') }}"> </script>
{% endblock %}

{% block content %}
    {% for product in products %}
        <div class = "product" id = "product-{{ product.id }}">
            <img src="{{ url_for('shop.static', filename = '/images/' + product.name + '.png') }}" class = "product-image" id = "image-{{ product.id }}">
            <button class = "edit-button edit-image-button" id = "edit-image-{{ product.id }}" name = "ФОТОГРАФІЇ ТОВАРУ">
                <img src="{{ url_for('admin.static', filename = '/images/pencil.png') }}" alt="edit" class = "edit-image">
            </button>
            
            <div class = "product-info">
                <div class = "product-property">
                    <h2 class = "product-name" id = "name-{{ product.id }}">{{ product.name }}</h2>
                    <button class = "edit-button edit-name-button" id = "edit-name-{{ product.id }}" name = "ІМЕНІ ТОВАРУ">
                        <img src = "{{ url_for('admin.static', filename = '/images/pencil.png') }}" alt = "edit" class = "edit-image">
                    </button>
                </div>
                <div class = 'block-product-price'>
                    <div class = "product-property">
                        <p class = 'product-price-crossed' id = "price-{{ product.id }}">{{ product.price }} грн</p>
                        <button class = "edit-button edit-price-product" id = "edit-price-{{ product.id }}" name = "ВАРТОСТІ ТОВАРУ">
                            <img src = "{{ url_for('admin.static', filename = '/images/pencil.png') }}" alt = "edit" class = "edit-image">
                        </button>
                    </div>
                    <div class = "product-property">
                        <p class = 'product-discount-percent' id = "discount-{{ product.id }}">Знижка {{ product.discount }}%</p>
                        <button class = "edit-button edit-discount-button" id = "edit-discount-{{ product.id }}" name = "ЗНИЖКИ ТОВАРУ У ВІДСОТКАХ">
                            <img src = "{{ url_for('admin.static', filename = '/images/pencil.png') }}" alt="edit" class = "edit-image">
                        </button>
                    </div>
                    <p class = 'product-discount'>{{ (product.price * product.discount / 100) | int }} грн</p>
                </div>
                <button class = "add-product button-stock-{{ product.in_stock }}" id = '{{ product.id }}'>КУПИТИ</button>
                {% for property in product.description.split(";") %}
                    <!-- <p>{{ property }} --- {{ product.description }} --- {{ product.description.split(";") }}</p> -->
                    {% set property_name = property.split(':')[0] %}
                    <p class = "product-property">{{ property.split(":")[0] }}:</p>
                    <div class = "property-block">
                        {% set property_raw = property.split(":")[1] %}
                        {% set property_values = property_raw.split("/") %}
                        <p class = "property" id = "property0-{{ product.id }}-{{ property_name }}">{{ property_values[0] }}</p>
                        <button class = "edit-button property-edit-product" id = "edit-property0-{{ product.id }}-{{ property_name }}" name = "ПОРІВНЯННЯ ДЛЯ ПОКАЗНИКА {{ property_name.upper() }}">
                            <img src = "{{ url_for('admin.static', filename = '/images/pencil.png') }}" alt="edit" class = "edit-image">
                        </button>
                        <p class = "property selected-property" id = "property1-{{ product.id }}-{{ property_name }}">{{ property_values[1] }}</p>
                        <button class = "edit-button property-edit-product" id = "edit-property1-{{ product.id }}-{{ property_name }}" name = "ПОКАЗНИКА {{ property_name.upper() }} У ТОВАРУ">
                            <img src = "{{ url_for('admin.static', filename = '/images/pencil.png') }}" alt="edit" class = "edit-image">
                        </button> 
                        <p class = "property" id = "property2-{{ product.id }}-{{ property_name }}">{{ property_values[2] }}</p>
                        <button class = "edit-button property-edit-product" id = "edit-property2-{{ product.id }}-{{ property_name }}" name = "ПОРІВНЯННЯ ДЛЯ ПОКАЗНИКА {{ property_name.upper() }}">
                            <img src = "{{ url_for('admin.static', filename = '/images/pencil.png') }}" alt="edit" class = "edit-image">
                        </button>
                    </div>
                {% endfor %}
                <div class = "product-in-stock" id = "{{ product.in_stock }}">
                    {% if product.in_stock == 1 %}
                        <img class = "in-stock-image" id = "in-stock" src="{{ url_for('shop.static', filename = '/images/in_stock.png') }} "  >
                    {% else %}
                        <img class = "in-stock-image" id = "not-in-stock" src="{{ url_for('shop.static', filename = '/images/not_in_stock.png') }}">
                    {% endif %}
                    <p class = "in-stock-text">ТОВАР В НАЯВНОСТІ</p>
                </div>
            </div>
        </div>
    {% endfor %}
    <div class = 'blur'>
        <div class = 'modal-dialog'>
            <button class = "modal-close">⨉</button>
            <h1 class = "modal-header">ЗАДАЙТЕ НОВЕ ЗНАЧЕННЯ ПАРАМЕТРУ</h1>
            <form method = "post" class = "send-form" enctype="multipart/form-data">
                <input type="text" name="new-value" class = "modal-input" required>
                <button class = "modal-confirm">ПІДТВЕРДИТИ</button>
            </form>
        </div>
    </div>
{% endblock %}